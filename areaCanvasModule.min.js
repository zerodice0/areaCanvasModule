function Point(e,t){"use strict";var n=0,r=0;e&&(n=e),t&&(r=t),this.getX=function(){return n},this.getY=function(){return r},this.setX=function(e){e&&(n=e)},this.setY=function(e){e&&(r=e)},this.get=function(){return this},this.getPoint=function(){return{x:n,y:r}},this.setPoint=function(e,t){e&&(n=e),t&&(r=t)},this.toString=function(){return`(${n}, ${r})`}}function AreaCanvasModule(){"use strict";function e(e){return null==e||null==e}function t(){var e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),t=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),n=window.navigator.userAgent,r=-1;return"Microsoft Internet Explorer"==window.navigator.appName?null!=e.exec(n)&&(r=parseFloat(RegExp.$1)):"Netscape"==window.navigator.appName&&null!=t.exec(n)&&(r=parseFloat(RegExp.$1)),r}function n(e,t){if(e<0)return!1;if(!R[e]&&R[e].length<F)for(var n=0;n<=e;n++)null==R[n]&&(R[n]=new Array);if(t&&t instanceof Point)R[e].push(t),G("new Point Object("+t.getX()+", "+t.getY()+") is add to area"+e+".");else{if(null==t.x||null==t.y)return G("param error!"),!1;R[e].push(new Point(t.x,t.y)),G("new Point Object("+t.x+", "+t.y+") is add to area"+e+".")}return i(),!0}function r(){var e=0,t=0,n=null,r=null,i=R.length,o=0;for(e=0;e<i;e++)if(n=R[e],o=n.length,!z||U==e){for(E.beginPath(),t=0;t<o;t++)r=n[t],0===t?(E.moveTo(r.getX(),r.getY()),E.arc(r.getX(),r.getY(),O,0,2*Math.PI,!0),E.fillStyle=S[e],E.fill(),E.moveTo(r.getX(),r.getY())):(E.lineTo(r.getX(),r.getY()),E.moveTo(r.getX(),r.getY()),E.arc(r.getX(),r.getY(),O,0,2*Math.PI,!0),E.fillStyle=S[e],E.fill(),E.moveTo(r.getX(),r.getY()));E.lineTo(n[0].getX(),n[0].getY()),E.globalAlpha=1,E.strokeStyle=S[e],E.stroke()}return!0}function i(e){var t=e||P.src;if(E.clearRect(0,0,p.width,p.height),o(t),1==H&&(j>=0||A>=0)){var n=A>=0?A:j;s(R[n],D)}return r(),!0}function o(e){var t=B;e&&(t=e),P=new Image(Y,m),P.onload=function(){p.style.background="url("+t+")",p.style.backgroundPosition=q+"px "+q+"px",p.style.backgroundSize=Y+"px "+m+"px",p.style.backgroundRepeat="no-repeat"},P.src=t}function l(e,t,n){var r=!1;if(!e instanceof Point)return r;if(!t instanceof Point)return r;if(!n instanceof Point)return r;var i=e,o=t,l=Math.min(i.getX(),o.getX()),a=Math.max(i.getX(),o.getX()),u=Math.min(i.getY(),o.getY()),g=Math.max(i.getY(),o.getY()),s=(o.getY()-i.getY())/(o.getX()-i.getX());return i.getY()==o.getY()&&i.getY()-O<n.getY()&&n.getY()<i.getY()+O&&l<n.getX()&&n.getX()<a?r=!0:i.getX()==o.getX()&&i.getX()-O<n.getX()&&n.getX()<i.getX()+O&&u<n.getY()&&n.getY()<g?r=!0:n.getY()-i.getY()-3<=s*(n.getX()-i.getX())&&s*(n.getX()-i.getX())<=n.getY()-i.getY()+3&&l<n.getX()&&n.getX()<a&&(r=!0),r}function a(){w=-1,x=-1,C=-1,T=-1}function u(e){var t=R[e];if(!t)return!1;for(var n=0,r=t[n];r;r=t[++n])(-1==x||x>r.getX())&&(x=r.getX()),(-1==w||w>r.getY())&&(w=r.getY()),(-1==C||C<r.getX())&&(C=r.getX()),(-1==T||T<r.getY())&&(T=r.getY());return!0}function g(e,t,n){E.beginPath();for(var r=0,i=n[r];i;i=n[++r])0==r?E.moveTo(i.getX(),i.getY()):E.lineTo(i.getX(),i.getY());return E.closePath(),E.isPointInPath(e,t)}function s(e,t){E.beginPath();for(var n=0,r=e[n];r;r=e[++n])0==n?E.moveTo(r.getX(),r.getY()):E.lineTo(r.getX(),r.getY());return E.closePath(),E.fillStyle=t,E.globalAlpha=L,E.fill()}function f(e){for(var t=[],n=0,r=e[n];r;r=e[++n])t.push(new Point(r.getX(),r.getY()));return t}function c(e){var t=p.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;G("click point: ("+n+", "+r+")"),E.beginPath();for(var o=0,l=R[U],g=l[o];g;g=l[++o])if(0==o?E.moveTo(g.getX(),g.getY()):E.lineTo(g.getX(),g.getY()),g.getX()-O<n&&n<g.getX()+O&&g.getY()-O<r&&r<g.getY()+O){0==e.button?(A=U,I=o):!$&&2==e.button&&l.length>3&&(e.preventDefault(),l.splice(o,1),i());break}E.closePath(),E.isPointInPath(n,r)&&A<0&&I<0&&(A=U,y=n,b=r,k=f(R[A]),a(),u(A))}function h(e){var t=p.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top;G("click point: ("+n+", "+r+")");for(var o=0,l=R[o];l;l=R[++o]){E.beginPath();for(var g=0,s=l[g];s;s=l[++g])if(0==g?E.moveTo(s.getX(),s.getY()):E.lineTo(s.getX(),s.getY()),s.getX()-O<n&&n<s.getX()+O&&s.getY()-O<r&&r<s.getY()+O){0==e.button?(A=o,I=g):!$&&2==e.button&&l.length>3&&(e.preventDefault(),l.splice(g,1),i());break}E.closePath(),E.isPointInPath(n,r)&&A<0&&I<0&&(A=o,y=n,b=r,k=f(R[A]),a(),u(A))}}var d=null,v=null,p=null,X=t(),Y=640,m=480,P=null,A=-1,y=-1,b=-1,w=-1,x=-1,C=-1,T=-1,I=-1,k=null,E=null,R=[],M=!1,O=3,F=16,N=4,B=null,S=["#EC7063","#AF7AC5","#5DADE2","#7DCEA0","#F4D03F","#EB984E"],$=!1,D="#CCAF0A",j=-1,L=.5,H=!0,z=!1,U=0,q=0,G=function(e){console&&console.log&&M&&console.log(e)};this.init=function(e){return null!=e.width&&(Y=e.width),null!=e.height&&(m=e.height),null!=e.debug&&(M=e.debug),null!=e.id&&(v=e.id),null!=e.pointNumberLimit&&(F=e.pointNumberLimit),null!=e.areaNumberLimit&&(N=e.areaNumberLimit),null!=e.defaultImage&&(B=e.defaultImage),null!=e.hoveredAreaColor&&(D=e.hoveredAreaColor),null!=e.hoveredAreaAlpha&&(L=e.hoveredAreaAlpha),null!=e.hoveredAreaHighlight&&(H=e.hoveredAreaHighlight),null!=e.modifyOnlyOneArea&&(z=e.modifyOnlyOneArea),null!=e.canvasPadding&&(q=e.canvasPadding),null!=e.arrayColor&&(S=function(e,t){var n=e,r=n.length,i=S.length;if(n.length<t)for(r=n.length;r<t&&r<i;r++)n.push(e[r]);return n}(e.arrayColor,N)),null!=e.isFixPointNumber&&($=e.isFixPointNumber),d=document.getElementById(v),d?(d.innerHTML=0<X&&X<10?"<span>not support Internet Explorer "+X+". Please using Chrome Browser.</span>":'<canvas width="'+(Y+q)+'" height="'+(m+q)+'"></canvas>',p=d.children[0],p?(E=p.getContext("2d"),o(B),p.onmousedown||(p.onmousedown=z?c:h),p.oncontextmenu||(p.oncontextmenu=function(e){e.preventDefault()}),p.onmousemove||(p.onmousemove=function(e){var t=p.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,o=0,l=0,a=null,s=0,f=0,c=0,h=0,d=!1;if(z)g(n-y,r-b,R[U])&&(j=U,d=!0);else for(f=0;f<R.length;f++)g(n-y,r-b,R[f])&&(j=f,d=!0);if(a=R[A],a){if(A>=0&&I>=0)a[I].setPoint(n,r),i();else if(A>=0&&y>=0&&b>=0){for(s=a.length,c=n-y,h=r-b,u(A),f=0;f<s;f++)o=a[f].getX()+c,l=a[f].getY()+h,a[f].setPoint(o,l);u(A),y=n,b=r,i()}}else j>=0&&0==d?(j=-1,i()):d&&i()}),p.onmouseup||(p.onmouseup=function(e){var t=p.getBoundingClientRect();e.clientX,t.left,e.clientY,t.top;if(G(`${w} ${T} ${x} ${C}`),I>=0){var n=R[A][I];w<0&&n.setY(0),T>m&&n.setY(m),x<0&&n.setX(0),C>Y&&n.setX(Y)}else A>=0&&(u(A),(x<0||w<0||C>Y||T>m)&&null!=k&&(R[A]=f(k)));i(),A=-1,y=-1,b=-1,a(),I=-1,k=null}),void(p.ondblclick||(p.ondblclick=function(e){if($)return!1;var t=0,n=0,r=null,o=null,a=null,u=R.length,g=0,s=p.getBoundingClientRect(),f=e.clientX-s.left,c=e.clientY-s.top,h=new Point(f,c);for(t=0;t<u;t++)if(r=R[t],g=r.length,g<F){for(n=1;n<g;n++)if(o=r[n-1],a=r[n],l(o,a,h)){r.splice(n,0,h);break}o=r[n-1],a=r[0],l(o,a,h)&&r.splice(n,0,h)}i()}))):(G("Can not create Canavas Element."),!1)):(G("paramElemId is not found."),!1)},this.getAllArea=function(){return R},this.getArea=function(e){return!(e<0)&&(!!R[e]&&R[e])},this.getAreaToRelativeCoordinates=function(e){if(e<0)return!1;if(!R[e])return!1;for(var t=[],n=null,r=0;r<R[e].length;r++)n=R[e][r],t.push(new Point(n.getX()/Y,n.getY()/m));return t},this.addPointToArea=function(e,t){return n(e,t)},this.addPointArrayToArea=function(e,t){if(e<0)return!1;if(e>N)return!1;if(!R[e])for(var n=0;n<=e;n++)null==R[n]&&(R[n]=new Array);for(var r in t)if(null!=t[r]&&t[r]instanceof Point)R[e].push(t[r]),G("new Point Object("+t[r].getX()+", "+t[r].getY()+") is add to area"+e+".");else{if(null==t[r].x||null==t[r].y)return G("param error!"),!1;R[e].push(new Point(t[r].x,t[r].y)),G("new Point Object("+t[r].x+", "+t[r].y+") is add to area"+e+".")}return i(),!0},this.addPushArrayToArea=function(e){var t=R.length;if(t>=N)return!1;for(var n in R[t]||(R[t]=new Array),e)if(null!=e[n]&&e[n]instanceof Point)R[t].push(e[n]),G("new Point Object("+e[n].getX()+", "+e[n].getY()+") is add to area"+t+".");else{if(null==e[n].x||null==e[n].y)return G("param error!"),!1;R[t].push(new Point(e[n].x,e[n].y)),G("new Point Object("+e[n].x+", "+e[n].y+") is add to area"+t+".")}return i(),!0},this.deletePointFromArea=function(e,t){return e<0?(G("paramAreaIndex is wrong!"),!1):t<0?(G("paramPointIndex is wrong!"),!1):null==R[e]?(G("arrayArea["+e+"] is undefined!"),!1):null==R[e][t]?(G("arrayArea["+e+"]["+t+"] is undefined!"),!1):R[e].length<4?(G("arrayArea["+e+"] has 3 points!"),!1):(R[e].splice(t,1),i(),!0)},this.setImageURL=function(e){return o(e),!0},this.refreshCanvas=function(e){return i(e),!0},this.drawRect=function(t,n,r,i,o){var l=0,a=0,u=0,g=0,s=0,f=0;return!(e(t)||e(n)||e(r)||e(i))&&(o&&o,t&&(l=t),n&&(a=n),r&&(u=r),i&&(g=i),s=u-l,f=g-a,E.beginPath(),E.strokeStyle="#8561c7",E.rect(l,a,s,f),E.stroke(),!0)},this.isModifyOnlyOneArea=function(){return z},this.changeModifyAreaIndex=function(e){return!(e<0||e>=R.length)&&(U=e,i(),!0)}}