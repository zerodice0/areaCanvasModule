function Point(t,e){"use strict";var n=0,r=0;t&&(n=t),e&&(r=e),this.getX=function(){return n},this.getY=function(){return r},this.setX=function(t){t&&(n=t)},this.setY=function(t){t&&(r=t)},this.get=function(){return this},this.getPoint=function(){return{x:n,y:r}},this.setPoint=function(t,e){t&&(n=t),e&&(r=e)}}function AreaCanvasModule(){"use strict";function t(t){return null==t||null==t}function e(){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),n=window.navigator.userAgent,r=-1;return"Microsoft Internet Explorer"==window.navigator.appName?null!=t.exec(n)&&(r=parseFloat(RegExp.$1)):"Netscape"==window.navigator.appName&&null!=e.exec(n)&&(r=parseFloat(RegExp.$1)),r}function n(t,e){if(t<0)return!1;if(!A[t]&&A[t].length<I)for(var n=0;n<=t;n++)null==A[n]&&(A[n]=new Array);if(e&&e instanceof Point)A[t].push(e),R("new Point Object("+e.getX()+", "+e.getY()+") is add to area"+t+".");else{if(null==e.x||null==e.y)return R("param error!"),!1;A[t].push(new Point(e.x,e.y)),R("new Point Object("+e.x+", "+e.y+") is add to area"+t+".")}return i(),!0}function r(){var t=0,e=0,n=null,r=null,i=A.length,o=0;for(t=0;t<i;t++){for(n=A[t],o=n.length,b.beginPath(),e=0;e<o;e++)r=n[e],0===e?(b.moveTo(r.getX(),r.getY()),b.arc(r.getX(),r.getY(),C,0,2*Math.PI,!0),b.fillStyle=M[t],b.fill(),b.moveTo(r.getX(),r.getY())):(b.lineTo(r.getX(),r.getY()),b.moveTo(r.getX(),r.getY()),b.arc(r.getX(),r.getY(),C,0,2*Math.PI,!0),b.fillStyle=M[t],b.fill(),b.moveTo(r.getX(),r.getY()));b.lineTo(n[0].getX(),n[0].getY()),b.strokeStyle=M[t],b.stroke()}return!0}function i(t){var e=null;return b.clearRect(0,0,c.width,c.height),e=t||m.src,o(e),r(),!0}function o(t){var e=k;t&&(e=t),m=new Image(h,d),m.onload=function(){c.style.background="url("+e+")",c.style.backgroundSize="100% 100%"},m.src=e}function a(t,e,n){if(!t instanceof Point)return!1;if(!e instanceof Point)return!1;if(!n instanceof Point)return!1;var r=t,i=e,o=Math.min(r.getX(),i.getX()),a=Math.max(r.getX(),i.getX()),u=Math.min(r.getY(),i.getY()),l=Math.max(r.getY(),i.getY()),g=(i.getY()-r.getY())/(i.getX()-r.getX());return r.getY()==i.getY()&&r.getY()-C<n.getY()&&n.getY()<r.getY()+C&&o<n.getX()&&n.getX()<a||(r.getX()==i.getX()&&r.getX()-C<n.getX()&&n.getX()<r.getX()+C&&u<n.getY()&&n.getY()<l||n.getY()-r.getY()-3<=g*(n.getX()-r.getX())&&g*(n.getX()-r.getX())<=n.getY()-r.getY()+3&&o<n.getX()&&n.getX()<a)}function u(){v=-1,P=-1,w=-1,y=-1}function l(t){var e=A[t];if(!e)return!1;for(var n=0,r=e[n];r;r=e[++n])(-1==P||P>r.getX())&&(P=r.getX()),(-1==v||v>r.getY())&&(v=r.getY()),(-1==w||w<r.getX())&&(w=r.getX()),(-1==y||y<r.getY())&&(y=r.getY());return!0}var g=null,s=null,c=null,f=e(),h=640,d=480,m=null,p=-1,X=-1,Y=-1,v=-1,P=-1,w=-1,y=-1,x=-1,b=null,A=[],E=!1,C=3,I=16,T=4,k=null,M=["#EC7063","#AF7AC5","#5DADE2","#7DCEA0","#F4D03F","#EB984E"],R=function(t){console&&console.log&&E&&console.log(t)};this.init=function(t){return t.width&&(h=t.width),t.height&&(d=t.height),t.debug&&(E=t.debug),t.id&&(s=t.id),t.pointNumberLimit&&(I=t.pointNumberLimit),t.areaNumberLimit&&(T=t.areaNumberLimit),t.defaultImage&&(k=t.defaultImage),t.arrayColor&&(M=function(t,e){var n=t,r=n.length,i=M.length;if(n.length<e)for(r=n.length;r<e&&r<i;r++)n.push(t[r]);return n}(t.arrayColor,T)),g=document.getElementById(s),g?(g.innerHTML=0<f&&f<10?"<span>not support Internet Explorer "+f+". Please using Chrome Browser.</span>":'<canvas width="'+h+'" height="'+d+'"></canvas>',c=g.children[0],c?(b=c.getContext("2d"),c.onmousedown||(c.onmousedown=function(t){var e=c.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;R("click point: ("+n+", "+r+")");for(var o=0,a=A[o];a;a=A[++o]){b.beginPath();for(var g=0,s=a[g];s;s=a[++g])if(0==g?b.moveTo(s.getX(),s.getY()):b.lineTo(s.getX(),s.getY()),s.getX()-C<n&&n<s.getX()+C&&s.getY()-C<r&&r<s.getY()+C){0==t.button?(p=o,x=g):2==t.button&&a.length>3&&(t.preventDefault(),a.splice(g,1),i());break}b.closePath(),b.isPointInPath(n,r)&&p<0&&x<0&&(p=o,X=n,Y=r,u(),l(p))}}),c.oncontextmenu||(c.oncontextmenu=function(t){t.preventDefault()}),c.onmousemove||(c.onmousemove=function(t){var e=c.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top,o=0,a=0,u=null,g=0,s=0,f=0,h=0;if(u=A[p],u)if(p>=0&&x>=0)u[x].setPoint(n,r),i();else if(p>=0&&X>=0&&Y>=0){for(g=u.length,f=n-X,h=r-Y,l(p),(f<0&&P+f<=0||f>0&&w+f>=c.width)&&(f=0,!0),(h<=0&&v+h<=0||h>0&&y+h>=c.height)&&(h=0,!0),s=0;s<g;s++)o=u[s].getX()+f,a=u[s].getY()+h,u[s].setPoint(o,a);l(p),X=n,Y=r,i()}}),c.onmouseup||(c.onmouseup=function(t){p=-1,X=-1,Y=-1,u(),x=-1}),void(c.ondblclick||(c.ondblclick=function(t){var e=0,n=0,r=null,o=null,u=null,l=A.length,g=0,s=c.getBoundingClientRect(),f=t.clientX-s.left,h=t.clientY-s.top,d=new Point(f,h);for(e=0;e<l;e++)if(r=A[e],g=r.length,g<I){for(n=1;n<g;n++)if(o=r[n-1],u=r[n],a(o,u,d)){r.splice(n,0,d);break}o=r[n-1],u=r[0],a(o,u,d)&&r.splice(n,0,d)}i()}))):(R("Can not create Canavas Element."),!1)):(R("paramElemId is not found."),!1)},this.getAllArea=function(){return A},this.getArea=function(t){return!(t<0)&&(!!A[t]&&A[t])},this.addPointToArea=function(t,e){return n(t,e)},this.addPointArrayToArea=function(t,e){if(t<0)return!1;if(t>T)return!1;if(!A[t])for(var n=0;n<=t;n++)null==A[n]&&(A[n]=new Array);for(var r in e)if(null!=e[r]&&e[r]instanceof Point)A[t].push(e[r]),R("new Point Object("+e[r].getX()+", "+e[r].getY()+") is add to area"+t+".");else{if(null==e[r].x||null==e[r].y)return R("param error!"),!1;A[t].push(new Point(e[r].x,e[r].y)),R("new Point Object("+e[r].x+", "+e[r].y+") is add to area"+t+".")}return i(),!0},this.addPushArrayToArea=function(t){var e=A.length;if(e>=T)return!1;for(var n in A[e]||(A[e]=new Array),t)if(null!=t[n]&&t[n]instanceof Point)A[e].push(t[n]),R("new Point Object("+t[n].getX()+", "+t[n].getY()+") is add to area"+e+".");else{if(null==t[n].x||null==t[n].y)return R("param error!"),!1;A[e].push(new Point(t[n].x,t[n].y)),R("new Point Object("+t[n].x+", "+t[n].y+") is add to area"+e+".")}return i(),!0},this.deletePointFromArea=function(t,e){return t<0?(R("paramAreaIndex is wrong!"),!1):e<0?(R("paramPointIndex is wrong!"),!1):null==A[t]?(R("arrayArea["+t+"] is undefined!"),!1):null==A[t][e]?(R("arrayArea["+t+"]["+e+"] is undefined!"),!1):A[t].length<4?(R("arrayArea["+t+"] has 3 points!"),!1):(A[t].splice(e,1),i(),!0)},this.setImageURL=function(t){return o(t),!0},this.refreshCanvas=function(t){return i(t),!0},this.drawRect=function(e,n,r,i,o){var a=0,u=0,l=0,g=0,s=0,c=0;return!(t(e)||t(n)||t(r)||t(i))&&(o&&o,e&&(a=e),n&&(u=n),r&&(l=r),i&&(g=i),s=l-a,c=g-u,b.beginPath(),b.strokeStyle="#8561c7",b.rect(a,u,s,c),b.stroke(),!0)}}