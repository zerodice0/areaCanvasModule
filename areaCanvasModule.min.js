function Point(t,e){"use strict";var n=0,i=0;t&&(n=t),e&&(i=e),this.getX=function(){return n},this.getY=function(){return i},this.setX=function(t){t&&(n=t)},this.setY=function(t){t&&(i=t)},this.get=function(){return this},this.getPoint=function(){return{x:n,y:i}},this.setPoint=function(t,e){t&&(n=t),e&&(i=e)}}function AreaCanvasModule(){"use strict";function t(){var t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),n=window.navigator.userAgent,i=-1;return"Microsoft Internet Explorer"==window.navigator.appName?null!=t.exec(n)&&(i=parseFloat(RegExp.$1)):"Netscape"==window.navigator.appName&&null!=e.exec(n)&&(i=parseFloat(RegExp.$1)),i}function e(t,e){if(t<0)return!1;if(!b[t]&&b[t].length<T)for(var n=0;n<=t;n++)null==b[n]&&(b[n]=new Array);if(e&&e instanceof Point)b[t].push(e),M("new Point Object("+e.getX()+", "+e.getY()+") is add to area"+t+".");else{if(null==e.x||null==e.y)return M("param error!"),!1;b[t].push(new Point(e.x,e.y)),M("new Point Object("+e.x+", "+e.y+") is add to area"+t+".")}return i(),!0}function n(){var t=0,e=0,n=null,i=null,r=b.length,o=0;for(t=0;t<r;t++){for(n=b[t],o=n.length,y.beginPath(),e=0;e<o;e++)i=n[e],0===e?(y.moveTo(i.getX(),i.getY()),y.arc(i.getX(),i.getY(),E,0,2*Math.PI,!0),y.fillStyle=I[t],y.fill(),y.moveTo(i.getX(),i.getY())):(y.lineTo(i.getX(),i.getY()),y.moveTo(i.getX(),i.getY()),y.arc(i.getX(),i.getY(),E,0,2*Math.PI,!0),y.fillStyle=I[t],y.fill(),y.moveTo(i.getX(),i.getY()));y.lineTo(n[0].getX(),n[0].getY()),y.strokeStyle=I[t],y.stroke()}return!0}function i(t){var e=null;return y.clearRect(0,0,s.width,s.height),e=t||d.src,r(e),n(),!0}function r(t){var e="/images/imgfail.jpg";t&&(e=t),d=new Image(f,h),d.onload=function(){s.style.background="url("+e+")",s.style.backgroundSize="100% 100%"},d.src=e}function o(t,e,n){if(!t instanceof Point)return!1;if(!e instanceof Point)return!1;if(!n instanceof Point)return!1;var i=t,r=e,o=Math.min(i.getX(),r.getX()),a=Math.max(i.getX(),r.getX()),g=Math.min(i.getY(),r.getY()),u=Math.max(i.getY(),r.getY()),l=(r.getY()-i.getY())/(r.getX()-i.getX());return i.getY()==r.getY()&&i.getY()-E<n.getY()&&n.getY()<i.getY()+E&&o<n.getX()&&n.getX()<a||(i.getX()==r.getX()&&i.getX()-E<n.getX()&&n.getX()<i.getX()+E&&g<n.getY()&&n.getY()<u||n.getY()-i.getY()-3<=l*(n.getX()-i.getX())&&l*(n.getX()-i.getX())<=n.getY()-i.getY()+3&&o<n.getX()&&n.getX()<a)}function a(){Y=-1,v=-1,P=-1,w=-1}function g(t){var e=b[t];if(!e)return!1;for(var n=0,i=e[n];i;i=e[++n])(-1==v||v>i.getX())&&(v=i.getX()),(-1==Y||Y>i.getY())&&(Y=i.getY()),(-1==P||P<i.getX())&&(P=i.getX()),(-1==w||w<i.getY())&&(w=i.getY());return!0}var u=null,l=null,s=null,c=t(),f=640,h=480,d=null,m=-1,p=-1,X=-1,Y=-1,v=-1,P=-1,w=-1,x=-1,y=null,b=[],A=!1,E=3,T=16,C=4,I=["#EC7063","#AF7AC5","#5DADE2","#7DCEA0","#F4D03F","#EB984E"],M=function(t){console&&console.log&&A&&console.log(t)};this.init=function(t){return t.width&&(f=t.width),t.height&&(h=t.height),t.debug&&(A=t.debug),t.id&&(l=t.id),t.pointNumberLimit&&(T=t.pointNumberLimit),t.areaNumberLimit&&(C=t.areaNumberLimit),u=document.getElementById(l),u?(u.innerHTML=0<c&&c<10?"<span>not support Internet Explorer "+c+". Please using Chrome Browser.</span>":'<canvas width="'+f+'" height="'+h+'"></canvas>',s=u.children[0],s?(y=s.getContext("2d"),s.onmousedown||(s.onmousedown=function(t){var e=s.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top;M("click point: ("+n+", "+r+")");for(var o=0,u=b[o];u;u=b[++o]){y.beginPath();for(var l=0,c=u[l];c;c=u[++l])if(0==l?y.moveTo(c.getX(),c.getY()):y.lineTo(c.getX(),c.getY()),c.getX()-E<n&&n<c.getX()+E&&c.getY()-E<r&&r<c.getY()+E){0==t.button?(m=o,x=l):2==t.button&&u.length>3&&(t.preventDefault(),u.splice(l,1),i());break}y.closePath(),y.isPointInPath(n,r)&&m<0&&x<0&&(m=o,p=n,X=r,a(),g(m))}}),s.oncontextmenu||(s.oncontextmenu=function(t){t.preventDefault()}),s.onmousemove||(s.onmousemove=function(t){var e=s.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top,o=0,a=0,u=null,l=0,c=0,f=0,h=0;if(u=b[m],u)if(m>=0&&x>=0)u[x].setPoint(n,r),i();else if(m>=0&&p>=0&&X>=0){for(l=u.length,f=n-p,h=r-X,g(m),(f<0&&v+f<=0||f>0&&P+f>=s.width)&&(f=0,!0),(h<=0&&Y+h<=0||h>0&&w+h>=s.height)&&(h=0,!0),c=0;c<l;c++)o=u[c].getX()+f,a=u[c].getY()+h,u[c].setPoint(o,a);g(m),p=n,X=r,i()}}),s.onmouseup||(s.onmouseup=function(t){m=-1,p=-1,X=-1,a(),x=-1}),void(s.ondblclick||(s.ondblclick=function(t){var e=0,n=0,r=null,a=null,g=null,u=b.length,l=0,c=s.getBoundingClientRect(),f=t.clientX-c.left,h=t.clientY-c.top,d=new Point(f,h);for(e=0;e<u;e++)if(r=b[e],l=r.length,l<T){for(n=1;n<l;n++)if(a=r[n-1],g=r[n],o(a,g,d)){r.splice(n,0,d);break}a=r[n-1],g=r[0],o(a,g,d)&&r.splice(n,0,d)}i()}))):(M("Can not create Canavas Element."),!1)):(M("paramElemId is not found."),!1)},this.getAllArea=function(){return b},this.getArea=function(t){return!(t<0)&&(!!b[t]&&b[t])},this.addPointToArea=function(t,n){return e(t,n)},this.addPointArrayToArea=function(t,e){if(t<0)return!1;if(t>C)return!1;if(!b[t])for(var n=0;n<=t;n++)null==b[n]&&(b[n]=new Array);for(var r in e)if(null!=e[r]&&e[r]instanceof Point)b[t].push(e[r]),M("new Point Object("+e[r].getX()+", "+e[r].getY()+") is add to area"+t+".");else{if(null==e[r].x||null==e[r].y)return M("param error!"),!1;b[t].push(new Point(e[r].x,e[r].y)),M("new Point Object("+e[r].x+", "+e[r].y+") is add to area"+t+".")}return i(),!0},this.addPushArrayToArea=function(t){var e=b.length;if(e>=C)return!1;for(var n in b[e]||(b[e]=new Array),t)if(null!=t[n]&&t[n]instanceof Point)b[e].push(t[n]),M("new Point Object("+t[n].getX()+", "+t[n].getY()+") is add to area"+e+".");else{if(null==t[n].x||null==t[n].y)return M("param error!"),!1;b[e].push(new Point(t[n].x,t[n].y)),M("new Point Object("+t[n].x+", "+t[n].y+") is add to area"+e+".")}return i(),!0},this.deletePointFromArea=function(t,e){return t<0?(M("paramAreaIndex is wrong!"),!1):e<0?(M("paramPointIndex is wrong!"),!1):null==b[t]?(M("arrayArea["+t+"] is undefined!"),!1):null==b[t][e]?(M("arrayArea["+t+"]["+e+"] is undefined!"),!1):b[t].length<4?(M("arrayArea["+t+"] has 3 points!"),!1):(b[t].splice(e,1),i(),!0)},this.setImageURL=function(t){r(t)},this.refleshCanvas=function(){i()}}